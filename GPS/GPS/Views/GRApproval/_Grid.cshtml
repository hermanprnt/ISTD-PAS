@using GPS.Models.ReceivingList
@using GPS.CommonFunc
@{
    List<GRApproval> listData = ViewData["CMDData"] != null ? (List<GRApproval>)ViewData["CMDData"] : new List<GRApproval>();
}

<style type="text/css">
    .close {
        opacity: 1;
    }

    th {
        white-space: nowrap;
    }

    td {
        white-space: nowrap;
    }
</style>
@{
    if (listData.Count > 0)
    {
        <div class="row">
            <div class="col-xs-6" style="margin-top: 5px;">
                <div class="form-group-xs" style="margin-bottom: 4px;">
                    @if ( Html.Toyota().Authorization.IsAuthorizedToAccessFeature("GRApproval", "btn-approve"))
                    {
                        <button type="button" class="btn btn-success btn-xs" onclick="doApprove()" id="approveButton">
                            Approve
                        </button>
                    }
                </div>
            </div>
            <div class="col-xs-6 text-right">
                <div class="form-group-xs" style="margin-bottom: 4px;">
                    <button type="button" id="btnDetail" class="btn btn-primary btn-xs" onclick="
    if ($('.detailColumn').hasClass('hidden')) {
        $('.detailColumn').removeClass('hidden');
        $('#btnDetail').html('Hide Detail');
    }
    else {
        $('.detailColumn').addClass('hidden');
        $('#btnDetail').html('Show Detail');
    }">
                        Show Detail
                    </button>
                </div>
            </div>
        </div>
    }
}

<div class="row">
    <div class="table-responsive col-xs-12 col-sm-12" style="overflow: hidden;">
        <div style="border: 1pt solid #ccc;">
            <div id="tScrollHead" style="width: 100%; overflow: scroll;">
                <table id="dynamic-table" class="table table-striped table-bordered table-condensed table-fixed" style="width: 100%; max-width: 1803px;">
                    <thead>
                        <tr>
                            <th width="40px"><input type="checkbox" class="selectall" onclick="$('.grid-checkbox-body').prop('checked',this.checked)" /></th>
                            <th width="90px">Receiving No</th>
                            <th width="80px">Attachment</th>
                            <th width="80px">Receiving Date</th>
                            <th width="100px">Header Text</th>
                            <th width="100px">PO Number</th>
                            <th width="240px">Vendor</th>
                            <th width="50px">Currency</th>
                            <th width="80px">Total GR Amount</th>
                            <th width="90px">Status</th>
                            <th width="60px" class="detailColumn hidden">Created By</th>
                            <th width="100px" class="detailColumn hidden">Created Date</th>
                            <th width="60px" class="detailColumn hidden">Changed By</th>
                            <th width="100px" class="detailColumn hidden">Changed Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            if (listData.Count > 0)
                            {
                                foreach (var item in listData)
                                {
                                    <tr>
                                        <td style="width: 40px" class="text-center grid-checkbox-col">
                                            <input type="checkbox" class="grid-checkbox grid-checkbox-body" value="@item.MAT_DOC_NO" id="cb-@item.MAT_DOC_NO" last_change="@item.LastChange.ToSqlCompatibleFormat()" />
                                        </td>
                                        <td class="text-center" width="90px"><a href="javascript:OnDetail('@item.MAT_DOC_NO','@item.PO_NO','@item.HEADER_TEXT')">@item.MAT_DOC_NO</a></td>
                                        <td class="text-center" width="80px">
                                            @if (string.IsNullOrEmpty(item.SURAT_JALAN_PATH_ICON))
                                            {
                                                <a href='#' title="Surat Jalan File" style=" pointer-events: none;"><i class="fa fa-paperclip" aria-hidden="true"></i></a>
                                            }
                                            else
                                            {
                                                @Html.Raw(item.SURAT_JALAN_PATH_ICON)
                                            }
                                            @if (string.IsNullOrEmpty(item.OTHER_PATH_ICON))
                                            {
                                                <a href='#' title="Other File" style=" pointer-events: none;"><i class="fa fa-paperclip" aria-hidden="true"></i></a>
                                            }
                                            else
                                            {
                                                @Html.Raw(item.OTHER_PATH_ICON)
                                            }
                                        </td>
                                        <td class="text-center" width="80px">@item.DOCUMENT_DT.ToStandardFormat()</td>
                                        <td class="text-left" width="100px">@item.HEADER_TEXT</td>
                                        <td class="text-center" width="100px">@item.PO_NO</td>
                                        <td class="text-left" width="240px">@item.VENDOR_CD - @item.VENDOR_NAME</td>
                                        <td class="text-center" width="50px">@item.ITEM_CURRENCY</td>
                                        <td class="text-right" width="80px">@item.AMOUNT</td>
                                        <td class="text-left" width="90px">@item.STATUS</td>
                                        <td class="text-left detailColumn hidden" width="60px">@item.CREATED_BY</td>
                                        <td class="text-center detailColumn hidden" width="100px">@item.CREATED_DT.ToStandardFormatWithTimeAndSecond()</td>
                                        <td class="text-left detailColumn hidden" width="60px">@item.CHANGED_BY</td>
                                        <td class="text-center detailColumn hidden" width="100px">
                                            @if (item.CHANGED_DT.HasValue)
                                            {
                                                @item.CHANGED_DT.Value.ToStandardFormatWithTimeAndSecond()
                                            }
                                        </td>
                                    </tr>

                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="14" class="text-center">
                                        No data retrieved.
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
            <div>
                <table class="table table-striped table-bordered table-condensed table-fixed" style="width: 100%">
                    <tfoot>
                        <tr>
                            <td class="col-xs-8 listdata">
                                @Html.Partial("_Paging")
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        if ($('#ApproveEnableHid').val() == '1') {
            $('#approveButton').prop('disabled', false);
        }
        else {
            $('#approveButton').prop('disabled', true);
        }
    });

</script>